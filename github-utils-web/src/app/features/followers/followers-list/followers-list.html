<div class="followers-container">
  <div class="header-section">
    <h1 class="followers-title">GitHub Non-Followers</h1>
    <p class="header-subtitle">People you follow who don't follow you back</p>
  </div>

  <!-- Success Message -->
  @if (successMessage() && !loading()) {
    <div class="success-message">
      <svg class="success-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="m9 12 2 2 4-4"></path>
        <circle cx="12" cy="12" r="10"></circle>
      </svg>
      <span>{{ successMessage() }}</span>
      <button class="dismiss-btn" (click)="dismissSuccessMessage()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
  }

  <!-- Loading State -->
  @if (loading()) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Loading followers...</p>
    </div>
  }

  <!-- Error State -->
  @if (error() && !loading()) {
    <div class="error-container">
      <svg class="error-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      <h2>Error Loading Non-Followers</h2>
      <p>{{ error() }}</p>
      <button class="retry-button" (click)="retryLoad()">Try Again</button>
    </div>
  }

  <!-- Empty State -->
  @if (!loading() && !error() && followers().length === 0) {
    <div class="empty-container">
      <svg class="empty-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="9" cy="7" r="4"></circle>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
      </svg>
      <h2>No Non-Followers Yet</h2>
      <p>You don't have any non-followers at the moment.</p>
    </div>
  }

   @if (!loading() && !error() && followers().length > 0) {
  <!-- Action Bar -->
  <div class="action-bar">
    <div class="followers-stats">
      <svg class="stats-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="9" cy="7" r="4"></circle>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
      </svg>
      <span class="stats-text">
        {{ followers().length }}
        {{ followers().length === 1 ? 'non-follower' : 'non-followers' }} found
      </span>
    </div>
    
    <button 
      class="unfollow-btn"
      (click)="openConfirmModal()"
      [disabled]="followers().length === 0">
      <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="8.5" cy="7" r="4"></circle>
        <line x1="23" y1="11" x2="17" y2="11"></line>
      </svg>
      Unfollow All
    </button>
  </div>
  <div class="followers-grid">
    @for (follower of followers(); track follower.login) {
      <div class="follower-card">
        <a
          [href]="follower.html_url"
          target="_blank"
          rel="noopener noreferrer"
          class="follower-link"
        >
          <img
            [src]="'https://github.com/' + follower.login + '.png'"
            [alt]="follower.login + ' avatar'"
            class="follower-avatar"
          />
          <div class="follower-info">
            <h3 class="follower-login">{{ follower.login }}</h3>
          </div>
          <svg
            class="external-link-icon"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
          >
            <path
              d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"
            ></path>
            <polyline points="15 3 21 3 21 9"></polyline>
            <line x1="10" y1="14" x2="21" y2="3"></line>
          </svg>
        </a>
      </div>
    }
  </div>
}

<!-- Confirmation Modal -->
<app-confirmation-modal
  [isOpen]="showConfirmModal()"
  [title]="'Mass Unfollow Confirmation'"
  [message]="'Are you sure you want to unfollow all ' + followers().length + ' non-followers? This action cannot be undone.'"
  [confirmText]="'Unfollow All'"
  [cancelText]="'Cancel'"
  [isDestructive]="true"
  [isLoading]="unfollowLoading()"
  (confirm)="confirmMassUnfollow()"
  (cancel)="closeConfirmModal()">
</app-confirmation-modal>
</div>